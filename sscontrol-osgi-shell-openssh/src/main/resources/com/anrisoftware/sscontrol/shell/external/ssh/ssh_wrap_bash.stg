sshCmd(args) ::= <<
#!/bin/bash
<sshCommand(args)>
<if(args.privileged)>
<sshChdir(args.sudoChdir)>
<sshEnv(args.sudoEnv)>
sudo <args.shell> \<\< \eof2
<theCommand(args)>
eof2
<else>
<theCommand(args)>
<endif>
eof1
>>

sshCommand(args) ::= <%
ssh
<\ ><sshArgs(args)>
<\ ><sshDebug(args)>
<\ ><sshOptions(args, args.sshDefaultOptions)>
<\ ><sshOptions(args, args.sshOptions)>
<\ ><if(args.sshKey)><sshKeyOption(args)><endif>
<\ ><args.sshUser>@<args.sshHost>
<\ >"<args.shell>" \<\< \eof1
%>

theCommand(args) ::= <<
<sshChdir(args.chdir)>
<sshEnv(args.env)>
<args.command>
>>
